(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{2904:function(t,s,a){t.exports=a.p+"assets/img/1675328889302.c30332af.png"},2905:function(t,s,a){t.exports=a.p+"assets/img/1675329351573.e330fd0e.png"},2906:function(t,s,a){t.exports=a.p+"assets/img/1675387653034.4296bcc6.png"},2907:function(t,s,a){t.exports=a.p+"assets/img/1675387802368.d64af0e1.png"},2908:function(t,s,a){t.exports=a.p+"assets/img/1675387919014.ec66fe7b.png"},2909:function(t,s,a){t.exports=a.p+"assets/img/1675388166695.f09bdc93.png"},2910:function(t,s,a){t.exports=a.p+"assets/img/1675388289909.40f8a200.png"},2911:function(t,s,a){t.exports=a.p+"assets/img/1675388370485.2fe76827.png"},2912:function(t,s,a){t.exports=a.p+"assets/img/1675388842691.193e76d5.png"},2913:function(t,s,a){t.exports=a.p+"assets/img/1675389244167.5ef15c2a.png"},2914:function(t,s,a){t.exports=a.p+"assets/img/1675389538769.cb199d2f.png"},2915:function(t,s,a){t.exports=a.p+"assets/img/1675391016974.848ee992.png"},2916:function(t,s,a){t.exports=a.p+"assets/img/1675391456124.4ef82cbb.png"},2917:function(t,s,a){t.exports=a.p+"assets/img/1675391545523.58378483.png"},2918:function(t,s,a){t.exports=a.p+"assets/img/1675391972941.8ab9895c.png"},2919:function(t,s,a){t.exports=a.p+"assets/img/1675392418833.b2de0198.png"},2920:function(t,s,a){t.exports=a.p+"assets/img/1675392486304.1ba9a97d.png"},2921:function(t,s,a){t.exports=a.p+"assets/img/1675392552083.30ff2454.png"},2922:function(t,s,a){t.exports=a.p+"assets/img/1675393167883.7be11705.png"},2923:function(t,s,a){t.exports=a.p+"assets/img/1675392914044.feba4e8b.png"},2924:function(t,s,a){t.exports=a.p+"assets/img/1675393048945.7fa75a4d.png"},2925:function(t,s,a){t.exports=a.p+"assets/img/1675395069058.a8791419.png"},2926:function(t,s,a){t.exports=a.p+"assets/img/1675395345857.f6976a9a.png"},2927:function(t,s,a){t.exports=a.p+"assets/img/1675395616264.c71aee99.png"},2928:function(t,s,a){t.exports=a.p+"assets/img/1675395953604.71ac61eb.png"},6020:function(t,s,a){"use strict";a.r(s);var n=a(15),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"一-hooks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一-hooks"}},[t._v("#")]),t._v(" 一，Hooks")]),t._v(" "),n("h3",{attrs:{id:"_1-什么是hook"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么是hook"}},[t._v("#")]),t._v(" 1，什么是hook")]),t._v(" "),n("p",[t._v("hook是React官方提供的API，10多个。是V16.8中新增的。已经出来几年了。类似于Vue3中的组合式API。")]),t._v(" "),n("ul",[n("li",[t._v("作用：用于在函数式组件中模拟出类组件的功能。如：state，生命周期，ref，上下文...")]),t._v(" "),n("li",[t._v("价值：有了hook，我们就可以不再使用类组件。官方说了，并不是要淘汰类组件。hook不能出现在类组件。")]),t._v(" "),n("li",[t._v("哪些：useState, useEffect, useLayoutEffect，useContext, userReducer, useRef, useMemo, useCallback..")]),t._v(" "),n("li",[t._v("开源hook: react-use, ahooks...")])]),t._v(" "),n("h3",{attrs:{id:"_2-usestate"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-usestate"}},[t._v("#")]),t._v(" 2，useState")]),t._v(" "),n("p",[t._v("useState是用于在函数式组件中定义状态的。")]),t._v(" "),n("p",[t._v("使用之，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2904),alt:"1675328889302"}})]),t._v(" "),n("p",[t._v("看如下代码，说结果：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2905),alt:"1675329351573"}})]),t._v(" "),n("h3",{attrs:{id:"_3-useeffect"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-useeffect"}},[t._v("#")]),t._v(" 3，useEffect")]),t._v(" "),n("p",[t._v("effect是副作用的意思。作用：是用来模拟类组件中的生命周期的，不是模拟所有的生命周期，是模拟这三个componentDidMount/componentDidUpdate/componentWillUnmount生命周期。")]),t._v(" "),n("p",[t._v("类似于vue中的watchEffect，vue中的watchEffect会自动依赖依赖，React中的useEffect，需要手动指定依赖。")]),t._v(" "),n("p",[t._v("vue中的watchEffect语法：")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("watchEffect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("flush")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sync"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("p",[t._v("语法：")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("useEffect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// fn1中写副作用")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// fn2中清除副作用")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("依赖数组"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br")])]),n("p",[t._v("在fn1中写一些副作用，在fn2中清除副作用。")]),t._v(" "),n("p",[t._v("useEffect的工作流程（背会）：")]),t._v(" "),n("ul",[n("li",[t._v("当没有“依赖数组”这个参数时，初始化只执行fn1，当re-render时，先执行fn2，再执行fn1。当路由切换时，只执行fn2。")]),t._v(" "),n("li",[t._v("当有“依赖数组”这个参数时，但是是一个空数组，初始化只执行fn1，当re-render时，什么也不执行。当路由切换时，只执行fn2。")]),t._v(" "),n("li",[t._v('当有“依赖数组”这个参数时，但是不是一个空数组，初始化只执行fn1。有且仅有当“依赖数组"中的变量发生变化导致rerender时，先执行fn2，再执行fn1()。当路由切换时，只执行fn2。')])]),t._v(" "),n("p",[t._v("没有依赖数组时，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2906),alt:"1675387653034"}})]),t._v(" "),n("p",[t._v("fn1类似于类组件中的compoentDidMount，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2907),alt:"1675387802368"}})]),t._v(" "),n("p",[t._v("考虑有依赖数组，但是是一个空数组，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2908),alt:"1675387919014"}})]),t._v(" "),n("p",[t._v("考虑依赖数组中有数据，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2909),alt:"1675388166695"}})]),t._v(" "),n("p",[n("img",{attrs:{src:a(2910),alt:"1675388289909"}})]),t._v(" "),n("p",[t._v("依赖可以有多个，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2911),alt:"1675388370485"}})]),t._v(" "),n("p",[t._v("语法总结：")]),t._v(" "),n("ul",[n("li",[t._v("格式：useEffect(()=>{fn1, return fn2}, [依赖数组])")]),t._v(" "),n("li",[t._v("情况一：没有依赖数组，初始化时，执行fn1，rerender时，先fn2，再fn1。路由切换只执行fn2。")]),t._v(" "),n("li",[t._v("情况二：有依赖数组，是一个空数组。初始化时，执行fn1，rerender时，fn2和fn1都不执行。路由切换只执行fn2。")]),t._v(" "),n("li",[t._v("情况三：有依赖数组，依赖数组中有状态。初始化时，执行fn1，只有依赖数组中的状态变化了，rerender时，先fn2，再fn1。路由切换只执行fn2。")]),t._v(" "),n("li",[t._v("fn1相当于类组件中的componentDidMount")]),t._v(" "),n("li",[t._v("fn2相当于类组件中的componentWillUnMount")]),t._v(" "),n("li",[t._v("依赖数组，相当于类组件中的componentDidUpdate")])]),t._v(" "),n("p",[t._v("在一个函数式组件中，可以书写多个useEffect，多个useEffect，它们是彼此不影响，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2912),alt:"1675388842691"}})]),t._v(" "),n("p",[t._v("注意细节：")]),t._v(" "),n("ul",[n("li",[t._v("useEffect是用来执行副作用，建议一个useEffect只执行一个副作用。不要在同一个useEffect中同时执行多个副作用。")]),t._v(" "),n("li",[t._v("在函数式组件中，不要把副作用直接暴露在函数体内，一定要使用useEffect进行控制。如下：")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(2913),alt:"1675389244167"}})]),t._v(" "),n("p",[t._v("实现计数器，每隔一s加1，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2914),alt:"1675389538769"}})]),t._v(" "),n("h3",{attrs:{id:"_4-uselayouteffect"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-uselayouteffect"}},[t._v("#")]),t._v(" 4，useLayoutEffect")]),t._v(" "),n("p",[t._v("运行机制和useEffect是一样的，区别在于useLayoutEffect执行时候更早。一般在项目中很少用。在一些第三方库中用的比较多。在这个hook中，不能进行ref或dom操作。")]),t._v(" "),n("p",[t._v("代码如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2915),alt:"1675391016974"}})]),t._v(" "),n("h3",{attrs:{id:"_5-usecontext"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-usecontext"}},[t._v("#")]),t._v(" 5，useContext")]),t._v(" "),n("p",[t._v("函数式组件中是没有上下文的，使用useContext，就可以在函数式组件中使用上下文，说白了，就是提供了一个访问上下文的入口。")]),t._v(" "),n("p",[t._v("语法：")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ctx "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("useContext")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("上下文对象"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[t._v("代码如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2916),alt:"1675391456124"}})]),t._v(" "),n("p",[t._v("除了上面的写法，还有一种写法，使用useContext，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2917),alt:"1675391545523"}})]),t._v(" "),n("h3",{attrs:{id:"_6-useref"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-useref"}},[t._v("#")]),t._v(" 6，useRef")]),t._v(" "),n("p",[t._v("回顾昨天讲的ref与ref转化：")]),t._v(" "),n("ul",[n("li",[t._v("在类组件中，如果ref写在DOM元素上，目的是为了获取DOM元素，进而操作DOM元素。")]),t._v(" "),n("li",[t._v("如果ref写在类组件标签上，目的是为了获取组件实例。进而实现组件的通信。")]),t._v(" "),n("li",[t._v("如果ref写在函数组件标签上，会报错。需要使用ref转发，转发到了函数式组件中的JSX中的DOM标签上。进而获取函数式组件中的JSX中的DOM元素。")])]),t._v(" "),n("p",[t._v("直接上代码如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2918),alt:"1675391972941"}})]),t._v(" "),n("h3",{attrs:{id:"_7-usememo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-usememo"}},[t._v("#")]),t._v(" 7，useMemo")]),t._v(" "),n("p",[t._v("作用：用于性能优化，用于把一些比较消耗性能的计算进行缓存，类似于vue中的计算属性。")]),t._v(" "),n("p",[t._v("语法：")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" memoizedValue "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("useMemo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("computeExpensiveValue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[t._v('特点：有且仅有当”依赖数组"中的状态发生变化了，useMemo才会重新执行那个昂贵的计算。')]),t._v(" "),n("p",[t._v("注意：useMemo的第二个参数是依赖数且，也有三种写法，和useEffect一样。")]),t._v(" "),n("p",[t._v("computeExpensiveValue表示昂贵计算。")]),t._v(" "),n("p",[t._v("直接上代码，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2919),alt:"1675392418833"}})]),t._v(" "),n("p",[t._v("如果指定了依赖，只有依赖发变化了，才会重新计算，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2920),alt:"1675392486304"}})]),t._v(" "),n("p",[n("img",{attrs:{src:a(2921),alt:"1675392552083"}})]),t._v(" "),n("h3",{attrs:{id:"_8-usecallback"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-usecallback"}},[t._v("#")]),t._v(" 8，useCallback")]),t._v(" "),n("p",[t._v("作用：用于性能优化，用来缓存一个函数声明。")]),t._v(" "),n("p",[t._v("useCallback也的也不多，官方说，可以使用useMemo去代替useCallback。如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2922),alt:"1675393167883"}})]),t._v(" "),n("p",[t._v("语法：")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fn "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("useCallback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("依赖数组"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[t._v("先看如下的代码：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2923),alt:"1675392914044"}})]),t._v(" "),n("p",[t._v("使用useCallback把函数声明缓存起来，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2924),alt:"1675393048945"}})]),t._v(" "),n("h3",{attrs:{id:"_9-usereducer"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-usereducer"}},[t._v("#")]),t._v(" 9，useReducer")]),t._v(" "),n("p",[t._v("useState是用来定义状态的，如果有很多的状态，通过需要写多个useState。使用useReducer有一个好处，一个useReducer可以代替多个useState。是在React函数式组件中模块Redux的数据流。")]),t._v(" "),n("p",[t._v("useReducer可以一次性定义多个状态。 项目中用的也不多。后面讲redux，还会说这一个数据流。")]),t._v(" "),n("p",[t._v("语法：")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dispath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" foreUpdate "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" setState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("useReducer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reducer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    初始值\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("p",[t._v("直接上代码如下：")]),t._v(" "),n("div",{staticClass:"language-jsx line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-jsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" useEffect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" useReducer "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"react"')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// state表示状态，action表示信号，根据不同的信号，就可以针对性地修改状态")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// reducer 是管理员的意思，要修改状态必须通过reducer")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 管理员根据信号进行状态的修改")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 修改状态的流程：1）对于state进行深copy  2）修改更新state  3）返回修改后的state")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("reducer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newState "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1）对于state进行深copy")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 根据信号更新state")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("action"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// action是一个对象，对象中有一个type，不同的type表示不同的信号")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NUM_ADD"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n            newState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NUM_SUB"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n            newState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" newState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义初始值")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" initState "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("num")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("list")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"b"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("falg")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("A")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("props")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dispatch 是用来派发一个action,管理员就可以收到action")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dispatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("useReducer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reducer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" initState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n            ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("函数组件")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n            ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n            ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n            ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onClick")]),n("span",{pre:!0,attrs:{class:"token script language-javascript"}},[n("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NUM_ADD"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("+1")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n            ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onClick")]),n("span",{pre:!0,attrs:{class:"token script language-javascript"}},[n("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NUM_SUB"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("-1")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("A")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br"),n("span",{staticClass:"line-number"},[t._v("40")]),n("br")])]),n("p",[t._v("效果如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2925),alt:"1675395069058"}})]),t._v(" "),n("h3",{attrs:{id:"_10-useid"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-useid"}},[t._v("#")]),t._v(" 10，useId")]),t._v(" "),n("p",[t._v("作用：返回一个唯一的标识，在函数式组件的整个运行过程中都是唯一的。")]),t._v(" "),n("p",[t._v("注意：是V18版本新增的。")]),t._v(" "),n("p",[t._v("代码如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2926),alt:"1675395345857"}})]),t._v(" "),n("h3",{attrs:{id:"_11-usedeferredvalue"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_11-usedeferredvalue"}},[t._v("#")]),t._v(" 11，useDeferredValue")]),t._v(" "),n("p",[t._v("作用：和防抖类似。和真正的防抖区别在于，这个hook所延迟的时间是不确定，由浏览器自己决定。")]),t._v(" "),n("p",[t._v("直接上代码，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2927),alt:"1675395616264"}})]),t._v(" "),n("p",[t._v("上面发送ajax，对服务器造成很多的压力，需要防抖，有了useDeferredValue这个hook，我们就不需要实现防抖了，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(2928),alt:"1675395953604"}})]),t._v(" "),n("p",[t._v("大家自己下查一下。")]),t._v(" "),n("p",[t._v("剩下的没有说的，自己学习。")])])}),[],!1,null,null,null);s.default=e.exports}}]);